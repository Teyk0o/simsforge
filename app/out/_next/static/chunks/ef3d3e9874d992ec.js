(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8776,e=>{"use strict";var t=e.i(43476),i=e.i(71645);let r=(0,i.createContext)(void 0);function a({children:e}){let[a,o]=(0,i.useState)([]),n=(0,i.useRef)(new Map),l=(0,i.useCallback)(e=>{let t=n.current.get(e);t&&(clearTimeout(t),n.current.delete(e)),o(t=>t.filter(t=>t.id!==e))},[]),s=(0,i.useCallback)(e=>{let t=`toast_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i={id:t,...e,duration:e.duration??3e3};if(o(e=>[...e,i]),i.duration&&i.duration>0){let e=setTimeout(()=>{l(t)},i.duration);n.current.set(t,e)}return t},[l]),c=(0,i.useCallback)((e,t)=>{o(i=>{let r=i.map(i=>i.id===e?{...i,...t}:i);if("duration"in t){let i=t.duration,r=n.current.get(e);if(r&&(clearTimeout(r),n.current.delete(e)),i&&i>0){let t=setTimeout(()=>{l(e)},i);n.current.set(e,t)}}return r})},[l]),d=(0,i.useCallback)(()=>{n.current.forEach(e=>clearTimeout(e)),n.current.clear(),o([])},[]);return(0,t.jsx)(r.Provider,{value:{toasts:a,showToast:s,updateToast:c,dismissToast:l,clearAll:d},children:e})}function o(){let e=(0,i.useContext)(r);if(!e)throw Error("useToast must be used within a ToastProvider");return e}e.s(["ToastProvider",()=>a,"useToast",()=>o])},70249,67464,17637,52136,40485,e=>{"use strict";var t,i,r,a=e.i(22997),o=e.i(86682);(t=i||(i={}))[t.Start=0]="Start",t[t.Current=1]="Current",t[t.End=2]="End";class n extends o.Resource{async read(e){if(0===e.byteLength)return 0;let t=await (0,o.invoke)("plugin:fs|read",{rid:this.rid,len:e.byteLength}),i=function(e){let t=new Uint8ClampedArray(e),i=t.byteLength,r=0;for(let e=0;e<i;e++)r*=256,r+=t[e];return r}(t.slice(-8)),r=t instanceof ArrayBuffer?new Uint8Array(t):t;return e.set(r.slice(0,r.length-8)),0===i?null:i}async seek(e,t){return await (0,o.invoke)("plugin:fs|seek",{rid:this.rid,offset:e,whence:t})}async stat(){var e;return{isFile:(e=await (0,o.invoke)("plugin:fs|fstat",{rid:this.rid})).isFile,isDirectory:e.isDirectory,isSymlink:e.isSymlink,size:e.size,mtime:null!==e.mtime?new Date(e.mtime):null,atime:null!==e.atime?new Date(e.atime):null,birthtime:null!==e.birthtime?new Date(e.birthtime):null,readonly:e.readonly,fileAttributes:e.fileAttributes,dev:e.dev,ino:e.ino,mode:e.mode,nlink:e.nlink,uid:e.uid,gid:e.gid,rdev:e.rdev,blksize:e.blksize,blocks:e.blocks}}async truncate(e){await (0,o.invoke)("plugin:fs|ftruncate",{rid:this.rid,len:e})}async write(e){return await (0,o.invoke)("plugin:fs|write",{rid:this.rid,data:e})}}async function l(e,t){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");return new n(await (0,o.invoke)("plugin:fs|open",{path:e instanceof URL?e.toString():e,options:t}))}async function s(e,t){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");await (0,o.invoke)("plugin:fs|mkdir",{path:e instanceof URL?e.toString():e,options:t})}async function c(e,t){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");return await (0,o.invoke)("plugin:fs|read_dir",{path:e instanceof URL?e.toString():e,options:t})}async function d(e,t){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");let i=await (0,o.invoke)("plugin:fs|read_file",{path:e instanceof URL?e.toString():e,options:t});return i instanceof ArrayBuffer?new Uint8Array(i):Uint8Array.from(i)}async function f(e,t){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");await (0,o.invoke)("plugin:fs|remove",{path:e instanceof URL?e.toString():e,options:t})}async function u(e,t,i){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");if(t instanceof ReadableStream){let r=await l(e,{read:!1,create:!0,write:!0,...i}),a=t.getReader();try{for(;;){let{done:e,value:t}=await a.read();if(e)break;await r.write(t)}}finally{a.releaseLock(),await r.close()}}else await (0,o.invoke)("plugin:fs|write_file",t,{headers:{path:encodeURIComponent(e instanceof URL?e.toString():e),options:JSON.stringify(i)}})}async function h(e,t){if(e instanceof URL&&"file:"!==e.protocol)throw TypeError("Must be a file URL.");return await (0,o.invoke)("plugin:fs|exists",{path:e instanceof URL?e.toString():e,options:t})}o.Resource,e.s(["exists",()=>h,"mkdir",()=>s,"readDir",()=>c,"readFile",()=>d,"remove",()=>f,"writeFile",()=>u],67464);let m="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);for(var w=new Uint8Array(16),g=[],p=0;p<256;++p)g.push((p+256).toString(16).slice(1));let y=function(e,t,i){if(m&&!t&&!e)return m();var a=(e=e||{}).random||(e.rng||function(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(w)})();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){i=i||0;for(var o=0;o<16;++o)t[i+o]=a[o];return t}return function(e,t=0){return(g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+"-"+g[e[t+4]]+g[e[t+5]]+"-"+g[e[t+6]]+g[e[t+7]]+"-"+g[e[t+8]]+g[e[t+9]]+"-"+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]).toLowerCase()}(a)},P=new class{profilesDir=null;metadataFile=null;initialized=!1;async initialize(){if(!this.initialized)try{console.log("[ProfileService] initialize() starting"),console.log("[ProfileService] getting appDataDir");let e=await (0,a.appDataDir)();if(console.log("[ProfileService] appData path:",e),console.log("[ProfileService] joining paths"),this.profilesDir=await (0,a.join)(e,"SimsForge","Profiles"),this.metadataFile=await (0,a.join)(this.profilesDir,"profiles.meta.json"),console.log("[ProfileService] profilesDir:",this.profilesDir),console.log("[ProfileService] checking if profilesDir exists"),await h(this.profilesDir)||(console.log("[ProfileService] creating profilesDir"),await s(this.profilesDir,{recursive:!0}),console.log("[ProfileService] profilesDir created")),console.log("[ProfileService] checking if metadataFile exists"),!await h(this.metadataFile)){console.log("[ProfileService] creating default metadata");let e={activeProfileId:null,profiles:[],lastSync:new Date().toISOString()};await this.saveMetadata(e),console.log("[ProfileService] default metadata created")}this.initialized=!0,console.log("[ProfileService] initialize() complete")}catch(e){throw console.error("[ProfileService] initialize() error:",e),e}}async createProfile(e,t,i=[]){try{if(await this.ensureInitialized(),(await this.getAllProfiles()).some(t=>t.name===e))throw Error(`Profile "${e}" already exists`);let r={id:y(),name:e,description:t,tags:i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),mods:[],isActive:!1,iconColor:this.generateRandomColor()},o=await (0,a.join)(this.profilesDir,`${r.id}.json`);console.log("[ProfileService] Writing profile to:",o),await u(o,new TextEncoder().encode(JSON.stringify(r,null,2))),console.log("[ProfileService] Profile file written successfully");let n=await this.getMetadata();return n.profiles.push(r.id),n.lastSync=new Date().toISOString(),await this.saveMetadata(n),console.log("[ProfileService] Profile created successfully:",r.id),r}catch(e){throw console.error("[ProfileService] Error creating profile:",e),e}}async getAllProfiles(){await this.ensureInitialized();let e=await this.getMetadata(),t=[];for(let i of e.profiles){let e=await this.getProfile(i);e&&t.push(e)}return t.sort((e,t)=>e.name.localeCompare(t.name))}async getProfile(e){await this.ensureInitialized();let t=await (0,a.join)(this.profilesDir,`${e}.json`);if(!await h(t))return null;try{let e=await d(t),i=new TextDecoder;return JSON.parse(i.decode(e))}catch(t){return console.error(`Failed to parse profile ${e}:`,t),null}}async updateProfile(e,t){await this.ensureInitialized();let i=await this.getProfile(e);if(!i)throw Error(`Profile ${e} not found`);if(t.name&&t.name!==i.name&&(await this.getAllProfiles()).some(e=>e.name===t.name))throw Error(`Profile "${t.name}" already exists`);let r={...i,...t,id:i.id,createdAt:i.createdAt,updatedAt:new Date().toISOString()},o=await (0,a.join)(this.profilesDir,`${e}.json`);return await u(o,new TextEncoder().encode(JSON.stringify(r,null,2))),r}async deleteProfile(e){await this.ensureInitialized();let t=await this.getMetadata();if(t.activeProfileId===e)throw Error("Cannot delete the active profile. Deactivate it first.");let i=await (0,a.join)(this.profilesDir,`${e}.json`);await h(i)&&await f(i),t.profiles=t.profiles.filter(t=>t!==e),t.lastSync=new Date().toISOString(),await this.saveMetadata(t)}async addModToProfile(e,t){let i=await this.getProfile(e);if(!i)throw Error(`Profile ${e} not found`);let r=i.mods.findIndex(e=>e.modId===t.modId);r>=0?i.mods[r]=t:i.mods.push(t),await this.updateProfile(e,{mods:i.mods})}async removeModFromProfile(e,t){let i=await this.getProfile(e);if(!i)throw Error(`Profile ${e} not found`);i.mods=i.mods.filter(e=>e.modId!==t),await this.updateProfile(e,{mods:i.mods})}async getActiveProfile(){await this.ensureInitialized();let e=await this.getMetadata();return e.activeProfileId?this.getProfile(e.activeProfileId):null}async setActiveProfile(e){await this.ensureInitialized();let t=await this.getMetadata();if(e&&!await this.getProfile(e))throw Error(`Profile ${e} not found`);for(let i of t.profiles){let t=await this.getProfile(i);if(t){t.isActive=i===e;let r=await (0,a.join)(this.profilesDir,`${i}.json`);await u(r,new TextEncoder().encode(JSON.stringify(t,null,2)))}}t.activeProfileId=e,t.lastSync=new Date().toISOString(),await this.saveMetadata(t)}async toggleModInProfile(e,t,i){let r=await this.getProfile(e);if(!r)throw Error(`Profile ${e} not found`);let a=r.mods.find(e=>e.modId===t);if(!a)throw Error(`Mod ${t} not found in profile ${e}`);a.enabled=i,await this.updateProfile(e,{mods:r.mods})}async ensureInitialized(){this.initialized?console.log("[ProfileService] ensureInitialized: already initialized"):(console.log("[ProfileService] ensureInitialized: not initialized, calling initialize()"),await this.initialize(),console.log("[ProfileService] ensureInitialized: initialize() complete"))}async getMetadata(){try{let e=await d(this.metadataFile),t=new TextDecoder;return JSON.parse(t.decode(e))}catch(e){return console.error("Failed to read metadata:",e),{activeProfileId:null,profiles:[],lastSync:new Date().toISOString()}}}async saveMetadata(e){await u(this.metadataFile,new TextEncoder().encode(JSON.stringify(e,null,2)))}generateRandomColor(){let e=["#46C89B","#FF6B6B","#4ECDC4","#FFD93D","#A8E6CF","#FF8B94","#FFB3BA","#A0C4FF"];return e[Math.floor(Math.random()*e.length)]}};e.s(["profileService",0,P],70249);let S=new class{cacheDir=null;indexFile=null;CACHE_VERSION="1.0.0";initialized=!1;async initialize(){if(this.initialized)return;let e=await (0,a.appDataDir)();if(this.cacheDir=await (0,a.join)(e,"SimsForge","ModsCache"),this.indexFile=await (0,a.join)(this.cacheDir,"cache.index.json"),await h(this.cacheDir)||await s(this.cacheDir,{recursive:!0}),!await h(this.indexFile)){let e={version:this.CACHE_VERSION,entries:{},lastCleanup:new Date().toISOString()};await this.saveIndex(e)}this.initialized=!0}async addToCache(e,t,i,r){await this.ensureInitialized();let o=await this.calculateFileHash(i),n=await this.getIndex(),l=n.entries[o];if(l)return l.usedByProfiles.includes(r)||(l.usedByProfiles.push(r),n.entries[o]=l,await this.saveIndex(n)),l;let c=await (0,a.join)(this.cacheDir,o),d=await (0,a.join)(c,"files");await s(d,{recursive:!0});let f=await this.extractModToCache(i,d);l={fileHash:o,modId:e,fileName:t,fileSize:await this.getFileSize(i),downloadedAt:new Date().toISOString(),usedByProfiles:[r],files:f};let h=await (0,a.join)(c,"metadata.json");return await u(h,new TextEncoder().encode(JSON.stringify(l,null,2))),n.entries[o]=l,await this.saveIndex(n),l}async getCachedMod(e){return await this.ensureInitialized(),(await this.getIndex()).entries[e]||null}async getCachePath(e){return await this.ensureInitialized(),await (0,a.join)(this.cacheDir,e,"files")}async removeProfileFromCache(e){await this.ensureInitialized();let t=await this.getIndex(),i=!1,r=[];for(let[a,o]of Object.entries(t.entries)){let t=o.usedByProfiles.indexOf(e);t>=0&&(o.usedByProfiles.splice(t,1),i=!0,0===o.usedByProfiles.length&&r.push(a))}for(let e of r)await this.deleteCacheEntry(e),delete t.entries[e];i&&await this.saveIndex(t)}async cleanupOrphans(){await this.ensureInitialized();let e=await this.getIndex(),t=0,i=0,r=[];for(let[a,o]of Object.entries(e.entries))0===o.usedByProfiles.length&&(i+=o.fileSize,r.push(a),t++);for(let t of r)await this.deleteCacheEntry(t),delete e.entries[t];return t>0&&(e.lastCleanup=new Date().toISOString(),await this.saveIndex(e)),{deleted:t,freedBytes:i}}async getCacheStats(){await this.ensureInitialized();let e=await this.getIndex(),t=0,i=new Set;for(let r of Object.values(e.entries))t+=r.fileSize,r.usedByProfiles.forEach(e=>i.add(e));return{totalSize:t,totalMods:Object.keys(e.entries).length,totalProfiles:i}}async ensureInitialized(){this.initialized||await this.initialize()}async getIndex(){try{let e=await d(this.indexFile),t=new TextDecoder;return JSON.parse(t.decode(e))}catch(e){return console.error("Failed to read cache index:",e),{version:this.CACHE_VERSION,entries:{},lastCleanup:new Date().toISOString()}}}async saveIndex(e){await u(this.indexFile,new TextEncoder().encode(JSON.stringify(e,null,2)))}async calculateFileHash(e){return await (0,o.invoke)("calculate_file_hash",{filePath:e})}async getFileSize(e){return await (0,o.invoke)("get_file_size",{filePath:e})}async extractModToCache(e,t){try{await (0,o.invoke)("extract_zip",{zipPath:e,destDir:t})}catch(e){throw console.error("Failed to extract zip:",e),Error(`Failed to extract mod: ${e}`)}return(await this.findPackageFiles(t)).map(e=>({relativePath:e.substring(t.length).replace(/^[\\\/]/,""),fileName:e.split(/[\\\/]/).pop()||"",fileSize:0}))}async findPackageFiles(e){let t=[];try{for(let i of(await c(e))){let r=await (0,a.join)(e,i.name);if(i.isDirectory){let e=await this.findPackageFiles(r);t.push(...e)}else i.name.endsWith(".package")&&t.push(r)}}catch(e){console.error("Error reading directory:",e)}return t}async deleteCacheEntry(e){let t=await (0,a.join)(this.cacheDir,e);if(await h(t))try{await f(t,{recursive:!0})}catch(t){console.error(`Failed to delete cache entry ${e}:`,t)}}};e.s(["modCacheService",0,S],17637);let v=new class{async activateProfile(e,t){let i=[],r=0,n=0;try{await this.deactivateProfile(e)}catch(e){console.error("Warning: Failed to deactivate profile:",e)}for(let{source:l,modName:s}of t)try{let t=await (0,a.join)(e,s);await (0,o.invoke)("copy_directory",{source:l,target:t}),r++}catch(t){n++,i.push({sourcePath:l,targetPath:await (0,a.join)(e,s),error:t.toString()})}return{success:0===n,created:r,failed:n,errors:i}}async deactivateProfile(e){let t=[],i=0,r=0;try{for(let o of(await c(e)))if(o.isDirectory)try{let t=await (0,a.join)(e,o.name);await f(t,{recursive:!0}),i++}catch(i){r++,t.push({sourcePath:"",targetPath:await (0,a.join)(e,o.name),error:i.toString()})}}catch(i){r++,t.push({sourcePath:"",targetPath:e,error:`Failed to read mods directory: ${i.toString()}`})}return{success:0===r,created:i,failed:r,errors:t}}async verifySymlinks(e,t){try{return(await c(e)).filter(e=>e.isDirectory).length===t}catch(e){return console.error("Failed to verify mod files:",e),!1}}async listSymlinks(e){try{let t=await c(e);return await Promise.all(t.filter(e=>e.isDirectory).map(t=>(0,a.join)(e,t.name)))}catch(e){return console.error("Failed to list mod directories:",e),[]}}async canCreateSymlinks(){return!0}getSymlinkPermissionFix(){return{windows:"Ensure you have write permissions to the Mods directory",unix:"Ensure you have write permissions to the Mods directory"}}};e.s(["symlinkService",0,v],52136);let C=new class{async decryptData(e,t="simsforge-settings"){try{let i=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",i),a=await crypto.subtle.importKey("raw",r,"AES-GCM",!1,["decrypt"]),o=atob(e),n=new Uint8Array(o.length);for(let e=0;e<o.length;e++)n[e]=o.charCodeAt(e);let l=n.slice(0,12),s=n.slice(12),c=await crypto.subtle.decrypt({name:"AES-GCM",iv:l},a,s);return new TextDecoder().decode(c)}catch(e){return console.error("Decryption failed:",e),null}}async getPaths(){let e=null,t=null;{let i=localStorage.getItem("simsforge_game_path");i&&(e=await this.decryptData(i));let r=localStorage.getItem("simsforge_mods_path");r&&(t=await this.decryptData(r))}return e||t?(console.log("[Sims4PathDetector] Using user-configured paths from Settings"),{gamePath:e,modsPath:t}):(console.log("[Sims4PathDetector] No user-configured paths found, attempting auto-detection..."),{gamePath:e=await this.detectGamePath(),modsPath:t=await this.detectModsPath()})}async detectPaths(){return this.getPaths()}async detectGamePath(){for(let e of["C:\\Program Files\\EA Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe","C:\\Program Files (x86)\\Origin Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe","C:\\Program Files (x86)\\Steam\\steamapps\\common\\The Sims 4\\Game\\Bin\\TS4_x64.exe","D:\\Origin Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe","E:\\Origin Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe","C:\\Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe"])if(await h(e))return e;return null}async detectModsPath(){try{let e=await (0,a.documentDir)(),t=await (0,a.join)(e,"Electronic Arts","The Sims 4","Mods");if(await h(t))return t;let i=await (0,a.join)(e,"The Sims 4","Mods");if(await h(i))return i}catch(e){console.error("Failed to detect mods path:",e)}return null}async validatePaths(e){return{gameValid:!!e.gamePath&&await h(e.gamePath),modsValid:!!e.modsPath&&await h(e.modsPath)}}getPathErrorMessage(e){return e.gameValid||e.modsValid?e.gameValid?e.modsValid?"Paths are valid.":"Could not find the Mods folder. Run The Sims 4 once to create it, or check your Documents\\Electronic Arts\\The Sims 4 folder.":"Could not find The Sims 4 executable (TS4_x64.exe). Check your installation.":"Could not find The Sims 4 installation or Mods folder. Please install The Sims 4 and run the game once to create the Mods folder."}getSuggestedPaths(){return["C:\\Program Files\\EA Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe","C:\\Program Files (x86)\\Origin Games\\The Sims 4\\Game\\Bin\\TS4_x64.exe","C:\\Program Files (x86)\\Steam\\steamapps\\common\\The Sims 4\\Game\\Bin\\TS4_x64.exe"]}};e.s(["sims4PathDetector",0,C],40485)},79241,77854,e=>{"use strict";var t=e.i(43476),i=e.i(71645),r=e.i(70249),a=e.i(17637),o=e.i(52136),n=e.i(40485),l=e.i(8776);let s=(0,i.createContext)(void 0);function c({children:e}){let[c,d]=(0,i.useState)([]),[f,u]=(0,i.useState)(null),[h,m]=(0,i.useState)(!0),[w,g]=(0,i.useState)(null),[p,y]=(0,i.useState)(null),{showToast:P}=(0,l.useToast)();(0,i.useEffect)(()=>{S()},[]);let S=async()=>{try{console.log("[ProfileContext] Initialize starting"),m(!0),g(null),console.log("[ProfileContext] Initializing profileService"),await r.profileService.initialize(),console.log("[ProfileContext] profileService initialized"),console.log("[ProfileContext] Initializing modCacheService"),await a.modCacheService.initialize(),console.log("[ProfileContext] modCacheService initialized"),console.log("[ProfileContext] Detecting Sims 4 paths");let e=await n.sims4PathDetector.detectPaths();(await n.sims4PathDetector.validatePaths(e)).modsValid&&e.modsPath?(y(e.modsPath),console.log("[ProfileContext] Detected mods path:",e.modsPath)):console.warn("Could not auto-detect Sims 4 mods path"),console.log("[ProfileContext] Refreshing profiles"),await v(),console.log("[ProfileContext] Profiles loaded")}catch(e){console.error("Failed to initialize profiles:",e),g(e.message||"Unknown initialization error"),P({type:"error",title:"Profile initialization failed",message:e.message||"Unknown error",duration:5e3})}finally{m(!1)}},v=(0,i.useCallback)(async()=>{try{let e=await r.profileService.getAllProfiles();d(e);let t=await r.profileService.getActiveProfile();u(t),g(null)}catch(e){console.error("Failed to refresh profiles:",e),g(e.message)}},[]),C=(0,i.useCallback)(async(e,t,i)=>{try{console.log("[ProfileContext] createProfile called"),console.log("[ProfileContext] profileService initialized:",r.profileService);let a=await r.profileService.createProfile(e,t,i);return console.log("[ProfileContext] profileService.createProfile returned:",a),console.log("[ProfileContext] calling refreshProfiles"),await v(),console.log("[ProfileContext] refreshProfiles done"),P({type:"success",title:"Profile created",message:`"${e}" has been created successfully`,duration:3e3}),a}catch(e){throw P({type:"error",title:"Failed to create profile",message:e.message||"Unknown error",duration:5e3}),e}},[v,P]),x=(0,i.useCallback)(async(e,t)=>{try{await r.profileService.updateProfile(e,t),await v(),P({type:"success",title:"Profile updated",message:"Changes saved successfully",duration:3e3})}catch(e){throw P({type:"error",title:"Failed to update profile",message:e.message||"Unknown error",duration:5e3}),e}},[v,P]),D=(0,i.useCallback)(async e=>{try{await r.profileService.deleteProfile(e),await a.modCacheService.removeProfileFromCache(e),await v(),P({type:"success",title:"Profile deleted",message:"Profile removed successfully",duration:3e3})}catch(e){throw P({type:"error",title:"Failed to delete profile",message:e.message||"Unknown error",duration:5e3}),e}},[v,P]),F=(0,i.useCallback)(async e=>{try{if(!p)throw Error("Mods path not configured. Could not find The Sims 4 installation.");if(f&&await o.symlinkService.deactivateProfile(p),e){let t=await r.profileService.getProfile(e);if(!t)throw Error("Profile not found");let i=t.mods.filter(e=>e.enabled),n=await Promise.all(i.map(async e=>({source:await a.modCacheService.getCachePath(e.fileHash),modName:e.modName}))),l=await o.symlinkService.activateProfile(p,n);if(!l.success){console.error("[ProfileContext] Symlink creation errors:",l.errors);let e=l.errors.map(e=>`${e.targetPath}: ${e.error}`).join("\n");throw Error(`Failed to create ${l.failed} symlinks:
${e}

Check permissions and that The Sims 4 is not running.`)}}await r.profileService.setActiveProfile(e),await v()}catch(e){throw P({type:"error",title:"Failed to activate profile",message:e.message||"Unknown error",duration:5e3}),e}},[f,p,v,P]),E=(0,i.useCallback)(async(e,t)=>{try{await r.profileService.addModToProfile(e,t),await v()}catch(e){throw console.error("Failed to add mod to profile:",e),e}},[v]),k=(0,i.useCallback)(async(e,t)=>{try{await r.profileService.removeModFromProfile(e,t),f?.id===e?await F(e):await v(),P({type:"success",title:"Mod removed",message:"Mod removed from profile",duration:3e3})}catch(e){throw P({type:"error",title:"Failed to remove mod",message:e.message||"Unknown error",duration:5e3}),e}},[v,P,f,F]),I=(0,i.useCallback)(async(e,t,i)=>{try{await r.profileService.toggleModInProfile(e,t,i),f?.id===e?await F(e):await v()}catch(e){throw console.error("Failed to toggle mod:",e),e}},[v,f,F]),T=(0,i.useCallback)(()=>p,[p]);return(0,t.jsx)(s.Provider,{value:{profiles:c,activeProfile:f,isLoading:h,error:w,refreshProfiles:v,createProfile:C,updateProfile:x,deleteProfile:D,activateProfile:F,addModToProfile:E,removeModFromProfile:k,toggleModInProfile:I,getModsPath:T},children:e})}function d(){let e=(0,i.useContext)(s);if(!e)throw Error("useProfiles must be used within ProfileProvider");return e}e.s(["ProfileProvider",()=>c,"useProfiles",()=>d],79241);var f=e.i(69464);let u=new Map([["bold",i.createElement(i.Fragment,null,i.createElement("path",{d:"M208.49,191.51a12,12,0,0,1-17,17L128,145,64.49,208.49a12,12,0,0,1-17-17L111,128,47.51,64.49a12,12,0,0,1,17-17L128,111l63.51-63.52a12,12,0,0,1,17,17L145,128Z"}))],["duotone",i.createElement(i.Fragment,null,i.createElement("path",{d:"M216,56V200a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V56A16,16,0,0,1,56,40H200A16,16,0,0,1,216,56Z",opacity:"0.2"}),i.createElement("path",{d:"M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"}))],["fill",i.createElement(i.Fragment,null,i.createElement("path",{d:"M208,32H48A16,16,0,0,0,32,48V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM181.66,170.34a8,8,0,0,1-11.32,11.32L128,139.31,85.66,181.66a8,8,0,0,1-11.32-11.32L116.69,128,74.34,85.66A8,8,0,0,1,85.66,74.34L128,116.69l42.34-42.35a8,8,0,0,1,11.32,11.32L139.31,128Z"}))],["light",i.createElement(i.Fragment,null,i.createElement("path",{d:"M204.24,195.76a6,6,0,1,1-8.48,8.48L128,136.49,60.24,204.24a6,6,0,0,1-8.48-8.48L119.51,128,51.76,60.24a6,6,0,0,1,8.48-8.48L128,119.51l67.76-67.75a6,6,0,0,1,8.48,8.48L136.49,128Z"}))],["regular",i.createElement(i.Fragment,null,i.createElement("path",{d:"M205.66,194.34a8,8,0,0,1-11.32,11.32L128,139.31,61.66,205.66a8,8,0,0,1-11.32-11.32L116.69,128,50.34,61.66A8,8,0,0,1,61.66,50.34L128,116.69l66.34-66.35a8,8,0,0,1,11.32,11.32L139.31,128Z"}))],["thin",i.createElement(i.Fragment,null,i.createElement("path",{d:"M202.83,197.17a4,4,0,0,1-5.66,5.66L128,133.66,58.83,202.83a4,4,0,0,1-5.66-5.66L122.34,128,53.17,58.83a4,4,0,0,1,5.66-5.66L128,122.34l69.17-69.17a4,4,0,1,1,5.66,5.66L133.66,128Z"}))]]),h=i.forwardRef((e,t)=>i.createElement(f.default,{ref:t,...e,weights:u}));h.displayName="XIcon",e.s(["X",()=>h],77854)}]);